(function(e){function t(t){for(var o,a,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&p.push(r[a][0]),r[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(o=!1)}o&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={app:0},i=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"1a61":function(e,t,n){"use strict";var o=n("9bbe"),r=n.n(o);r.a},"1c88":function(e,t,n){},2395:function(e,t,n){},"328b":function(e,t,n){},3675:function(e,t,n){"use strict";var o=n("623e"),r=n.n(o);r.a},3922:function(e,t,n){"use strict";var o=n("7238"),r=n.n(o);r.a},"3cce":function(e,t,n){"use strict";var o=n("1c88"),r=n.n(o);r.a},4678:function(e,t,n){var o={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id="4678"},"56d7":function(e,t,n){"use strict";n.r(t);n("4de4"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=n("5c96"),i=n.n(r),a=(n("0fae"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)}),s=[],c=(n("c975"),n("ac1f"),n("5319"),{data:function(){return{version:""}},created:function(){this.setVersion()},mounted:function(){var e=this,t=this;this.clinkService.registerEvent("kickout",(function(e){t.$message.error("The system detects that your account is logged in elsewhere, and the current login has exited!"),t.$router.replace("/portal"),deleteCookie("agent"),"classic"===t.version?sforce.interaction.cti.disableClickToDial({}):(sforce.opencti.disableClickToDial({}),t.setPanelLabel("Clink Phone"))})),this.clinkService.registerEvent("status",(function(e){var n="",o=JSON.parse(getCookie("agent")).cno;if(e.cno==o){switch(console.log("ClinkAgent.EventType.STATUS",e),e.code){case"IDLE":n="Idle";break;case"PAUSE":n="Pause";break;case"OFFLINE":n="Offline";break;case"INVALID":n="Invalid";break;case"CALLING":n="Calling";break;case"RINGING":n="Ringing";break;case"BUSY":n="Busy";break;case"WRAPUP":n="Wrapup",t.$router.replace("/home"),localStorage.removeItem("calling_info");break;default:break}if(n){t.setPanelLabel("Clink Phone: "+n),localStorage.setItem("status",e.code),t.$store.commit("changeStatus",n);var r=JSON.parse(localStorage.getItem("calling_info"));if("RINGING"===e.code&&4===e.callType&&t.$router.replace({name:"bounding",params:{phoneNum:r.OutphoneNum,isOutbounding:!0,bindType:e.bindType}}),null!==r&&void 0!==r||"IDLE"!==e.code?null!=r&&void 0!=r&&"IDLE"===e.code&&(r.isOutbounding?-1!=e.action.indexOf("NoAnswer")?(localStorage.removeItem("calling_info"),t.$router.replace("/home")):"bounding"===r.page&&t.$router.replace({name:"bounding",params:{OutphoneNum:r.OutphoneNum,isOutbounding:r.isOutbounding,recordName:r.Name,phone:r.Phone,title:r.Title,account:r.Account,recordId:r.Id}}):(localStorage.removeItem("calling_info"),t.$router.replace("/home"))):(localStorage.removeItem("calling_info"),t.$router.replace("/home")),"BUSY"===e.code&&r){var i=r.phoneNum,a=r.needPop;r.page="connecting",a&&(r.needPop=!1),console.log("set into localStorage,calling_info:  "+JSON.stringify(r)),localStorage.setItem("calling_info",JSON.stringify(r)),"classic"===t.version&&r.recordId&&a?sforce.interaction.screenPop(r.recordId,!1,null):t.$router.replace({name:"connecting",params:{phoneNum:i,account:null,recordId:null}})}}}})),window.addEventListener("load",(function(){if("classic"===t.version){var e=function(e){var t=JSON.parse(e.result).number.replace("+","00").replace(" ","");console.log("Clicked phone number: "+JSON.parse(e.result).number+" ,formatted number: "+t);var n=function(n){if(console.log("OUTBOUNDING, contact search result is "+JSON.stringify(n)),n.result){var o=JSON.parse(n.result),r=o[0]?o[0]:{Name:JSON.parse(e.result).number},i={};i.OutphoneNum=t,i.page="bounding",i.isOutbounding=!0,i.Name=r.Name,i.Phone=r.Phone,i.Title=r.Title,i.Account=r.Account,i.Id=r.Id,console.log("set into localStorage,calling_info:  "+JSON.stringify(i)),localStorage.setItem("calling_info",JSON.stringify(i)),sforce.interaction.screenPop(r.Id,!1,null)}};sforce.interaction.runApex("SoftphoneContactSearchController ","getContacts","name="+t,n)};sforce.interaction.cti.onClickToDial(e)}else sforce.opencti.onClickToDial({listener:function(e){var n=e.number.replace("+","00").replace(" ","");console.log("Clicked phone number: "+e.number+" ,formatted number: "+n);var o={apexClass:"SoftphoneContactSearchController",methodName:"getContacts",methodParams:"name="+n,callback:function(e){if(console.log("OUTBOUNDING, contact search result is "+JSON.stringify(e)),e.success){var o=JSON.parse(e.returnValue.runApex),r=o[0]?o[0]:{Name:t.dialTpNum},i={};i.OutphoneNum=n,i.page="bounding",i.isOutbounding=!0,i.Name=r.Name,i.Phone=r.Phone,i.Title=r.Title,i.Account=r.Account,i.Id=r.Id,console.log("set into localStorage,calling_info:  "+JSON.stringify(i)),localStorage.setItem("calling_info",JSON.stringify(i)),t.$router.replace({name:"bounding",params:{OutphoneNum:n,isOutbounding:!0,recordName:r.Name,phone:r.Phone,title:r.Title,account:r.Account,recordId:r.Id}})}}};sforce.opencti.runApex(o)}})})),window.addEventListener("online",(function(){e.$message.success("Network connection success!")})),this.clinkService.registerEvent("breakLine",(function(e){"/portal"!=t.$route.path&&t.$alert("Connection lost! Click confirm to login again..",{confirmButtonText:"Confirm",callback:function(e){localStorage.removeItem("calling_info"),localStorage.removeItem("status"),"classic"===t.version?sforce.interaction.cti.disableClickToDial({}):(sforce.opencti.disableClickToDial({}),t.setPanelLabel("Clink Phone")),t.$router.replace("/portal")}})}));var n=JSON.parse(getCookie("agent"));setTimeout((function(){"classic"==t.version&&3==n.bindType||ClinkAgent.online(n)}),1e3)},methods:{setPanelLabel:function(e){sforce.opencti.setSoftphonePanelLabel({label:e})},setVersion:function(){var e=window.location.href;-1===e.indexOf("mode=Lightning")?(this.$store.commit("changeVersion","classic"),this.version="classic"):(this.$store.commit("changeVersion","lightning"),this.version="lightning")}}}),l=c,u=(n("7c55"),n("2877")),d=Object(u["a"])(l,a,s,!1,null,null,null),p=d.exports,f=n("8c4f"),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("Header"),n("Dial"),n("RecentRecord")],1)},h=[],g=(n("a4d3"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("2fa7")),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tinet-sf-header"},["1"==e.StatusValue?n("span",{staticStyle:{height:"10px !important",width:"10px !important","border-radius":"50% !important",background:"green",display:"inline-block","margin-left":"15px"}}):n("span",{staticStyle:{height:"10px !important",width:"10px !important","border-radius":"50% !important",background:"orange",display:"inline-block","margin-left":"15px"}}),n("el-select",{attrs:{disabled:e.disabledF},on:{change:e.changeStatus},model:{value:e.StatusValue,callback:function(t){e.StatusValue=t},expression:"StatusValue"}},[n("el-option",{attrs:{value:"1",label:"Idle",selected:""}},[n("span",{staticClass:"idle",staticStyle:{height:"10px !important",width:"10px !important","border-radius":"50% !important",background:"green",display:"inline-block","margin-right":"15px"}}),e._v("Idle ")]),n("el-option",{attrs:{value:"2",label:"Pause"}},[n("span",{staticClass:"pause",staticStyle:{height:"10px !important",width:"10px !important","border-radius":"50% !important",background:"orange",display:"inline-block","margin-right":"15px"}}),e._v("Pause ")]),n("el-button",{staticClass:"log-out",staticStyle:{width:"100%",border:"none"},on:{click:e.logOut}},[e._v("Log Out")])],1),n("div",{staticStyle:{width:"10%",margin:"10px auto",float:"right",position:"relative"}},[n("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[n("div",[n("a",{staticStyle:{"font-size":"12px",color:"#a4a9a4"}},[e._v("Agent No: ")]),n("a",{staticStyle:{float:"right"}},[e._v(e._s(e.cno))])]),n("div",[n("a",{staticStyle:{"font-size":"12px",color:"#a4a9a4"}},[e._v("Phone: ")]),n("a",{staticStyle:{float:"right"}},[e._v(e._s(e.phone))])]),n("div",[n("a",{staticStyle:{"font-size":"12px",color:"#a4a9a4"}},[e._v("Type: ")]),n("a",{staticStyle:{float:"right"}},[e._v(e._s(e.phone_type))])]),n("ul",{staticClass:"icon_lists dib-box",attrs:{slot:"reference"},slot:"reference"},[n("li",{staticStyle:{float:"left",width:"100%"}},[n("span",{staticClass:"icon iconfont"},[e._v("")])])])])],1),n("div",{staticStyle:{width:"10%",margin:"10px auto",float:"right",position:"relative"}},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.ping,placement:"bottom"}},[n("el-button",[e._v("下边")]),n("ul",{staticClass:"icon_lists dib-box"},[n("li",{staticStyle:{float:"left",width:"100%"}},[n("span",{staticClass:"icon iconfont"},[e._v("")])])])],1)],1)],1)},v=[],y=n("2f62");function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={name:"Header",data:function(){return{StatusValue:"1",cno:"",cname:"Agent",ping:"Collecting..",phone:"--",phone_type:"--",agent_info:"--",disabledF:!1}},computed:O({},Object(y["b"])({version:"getVersion"}),{statusT:function(){var e=this.$store.state.statusT;return""===e||"idle"===e.toLowerCase()?this.StatusValue="1":"pause"===e.toLowerCase()?this.StatusValue="2":this.StatusValue=e,this.$store.state.statusT}}),watch:{statusT:function(e,t){console.log("statusT "+t+" ->"+e)}},beforeMount:function(){switch(this.cno=JSON.parse(getCookie("agent")).cno,this.phone=JSON.parse(getCookie("agent")).bindTel,JSON.parse(getCookie("agent")).bindType){case 1:this.phone_type="Mobile";break;case 2:this.phone_type="Extension";break;case 3:this.phone_type="Soft Phone";break;default:break}this.disabledF="/home"!==this.$route.path},mounted:function(){var e=this,t=this;this.clinkService.registerEvent("ringing",(function(e){var n=e.customerNumber,o=getCookie("agent");if(1==e.callType){var r={};if(r.phoneNum=n,r.page="bounding",r.isOutbounding=!1,r.needPop=!0,console.log("set into localStorage,calling_info:  "+JSON.stringify(r)),localStorage.setItem("calling_info",JSON.stringify(r)),"classic"===t.version){var i=function(i){var a=function(i){if(console.log("incomming, contact search result is "+JSON.stringify(i)),i.result){var a=JSON.parse(i.result),s=a[0]?a[0]:{Name:n};s.Id&&(r.recordId=s.Id,localStorage.setItem("calling_info",JSON.stringify(r)))}t.$router.replace({name:"bounding",params:{phoneNum:e.customerNumber,isOutbounding:!1,recordName:s.Name,phone:s.Phone,title:s.Title,account:s.Account,recordId:s.Id,bindType:JSON.parse(o).bindType}})};sforce.interaction.runApex("SoftphoneContactSearchController ","getContacts","name="+n,a)};sforce.interaction.setVisible(!0,i)}else sforce.opencti.setSoftphonePanelVisibility({visible:!0,callback:function(){var n={apexClass:"SoftphoneContactSearchController",methodName:"getContacts",methodParams:"name="+e.customerNumber,callback:function(n){if(console.log("incomming, contact search result is "+JSON.stringify(n)),n.success){var r=JSON.parse(n.returnValue.runApex),i=r[0]?r[0]:{Name:e.customerNumber};i.Id?sforce.opencti.screenPop({type:sforce.opencti.SCREENPOP_TYPE.SOBJECT,params:{recordId:i.Id}}):sforce.opencti.screenPop({type:sforce.opencti.SCREENPOP_TYPE.NEW_RECORD_MODAL,params:{entityName:"Contact"}})}t.$router.replace({name:"bounding",params:{phoneNum:e.customerNumber,isOutbounding:!1,recordName:i.Name,phone:i.Phone,title:i.Title,account:i.Account,recordId:i.Id,bindType:JSON.parse(o).bindType}})}};sforce.opencti.runApex(n)}})}else t.$router.replace({name:"bounding",params:{phoneNum:e.customerNumber,isOutbounding:!0,bindType:JSON.parse(o).bindType}})})),this.clinkService.registerAction("ping",(function(t){e.ping=t.latency+" ms"}))},methods:{logOut:function(){var e=this,t={logoutMode:1,removeBinding:0,chatClose:1,logoutType:2};if(e.$router.replace("/portal"),deleteCookie("agent"),e.clinkService.logout(t),"classic"===e.version){var n=function(e){e.result};sforce.interaction.cti.disableClickToDial(n)}else sforce.opencti.disableClickToDial({callback:function(){}})},changeStatus:function(){console.log("状态切换",this.StatusValue),"1"==this.StatusValue?this.clinkService.unpause():this.clinkService.pause({pauseType:1,pauseDescription:"Pause"})}}},j=C,S=(n("a901"),Object(u["a"])(j,b,v,!1,null,null,null)),N=S.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"tinet-sf-dial"},[n("div",{staticClass:"tinet-sf-dial-left"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.dialTpNum,expression:"dialTpNum"}],staticClass:"telnum-input",attrs:{type:"text",placeholder:"Enter the phone number..."},domProps:{value:e.dialTpNum},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e._handleConfirmKey(t)},input:function(t){t.target.composing||(e.dialTpNum=t.target.value)}}})]),n("div",{staticClass:"tinet-sf-dial-right"},[n("div",{class:e.isKeyboardShow?"keyboard-open":"keyboard-close",on:{click:e.openKeyboard}},[n("i",{staticClass:"el-icon-s-grid"})])])]),e.isKeyboardShow?n("div",{staticClass:"tinet-sf-keyboard",on:{click:function(t){return t.stopPropagation(),e._handleKeyPress(t)}}},[n("div",{staticClass:"key-row"},[n("div",{staticClass:"key-cell",attrs:{"data-num":"1"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("1")])],1),n("div",{staticClass:"key-cell",attrs:{"data-num":"2"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("2")])],1),n("div",{staticClass:"key-cell",attrs:{"data-num":"3"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("3")])],1)]),n("div",{staticClass:"key-row"},[n("div",{staticClass:"key-cell",attrs:{"data-num":"4"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("4")])],1),n("div",{staticClass:"key-cell",attrs:{"data-num":"5"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("5")])],1),n("div",{staticClass:"key-cell",attrs:{"data-num":"6"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("6")])],1)]),n("div",{staticClass:"key-row"},[n("div",{staticClass:"key-cell",attrs:{"data-num":"7"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("7")])],1),n("div",{staticClass:"key-cell",attrs:{"data-num":"8"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("8")])],1),n("div",{staticClass:"key-cell",attrs:{"data-num":"9"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("9")])],1)]),n("div",{staticClass:"key-row"},[n("div",{staticClass:"key-cell",attrs:{"data-num":"*"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("*")])],1),n("div",{staticClass:"key-cell",attrs:{"data-num":"0"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("0")])],1),n("div",{staticClass:"key-cell",attrs:{"data-num":"#"}},[n("el-button",{attrs:{type:"primary",plain:""}},[e._v("#")])],1)]),n("div",{staticClass:"key-row"},[n("div",{staticClass:"key-cell",attrs:{title:"clear"}},[n("el-button",{attrs:{type:"warning"},on:{click:e._handleClearKey}},[n("i",{staticClass:"el-icon-close"})])],1),n("div",{staticClass:"key-cell"},[n("el-button",{attrs:{type:"success",title:"dial"},on:{click:e._handleConfirmKey}},[n("i",{staticClass:"el-icon-phone"})])],1),n("div",{staticClass:"key-cell",attrs:{title:"delete"}},[n("el-button",{attrs:{type:"warning"},on:{click:e._handleDeleteKey}},[n("i",{staticClass:"el-icon-minus"})])],1)])]):e._e()])},w=[];function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(n,!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $={name:"Dial",props:{},data:function(){return{isKeyboardShow:!1,dialTpNum:this.$store.phonenum}},computed:P({},Object(y["b"])({version:"getVersion"})),methods:{openKeyboard:function(){this.isKeyboardShow=!this.isKeyboardShow},_handleKeyPress:function(e){var t=e.target.innerText;this._handleNumberKey(t)},_handleDeleteKey:function(){var e=this.dialTpNum;if(!e.length)return!1;this.dialTpNum=e.substring(0,e.length-1)},_handleClearKey:function(){this.dialTpNum=""},_handleConfirmKey:function(){if(console.log("dialTpnumStore",this.$store.phonenum),console.log("dialTpnum",this.dialTpNum),!this.dialTpNum.length||!this.dialTpNum)return this.$message.error("Number is empty!"),!1;if(this.checkPhone(this.dialTpNum)){var e=this;if("classic"===e.version){var t=function(t){var n=JSON.parse(t.result);if(t.result){n=JSON.parse(t.result);var o=n[0]?n[0]:{Name:e.dialTpNum},r={};r.OutphoneNum=e.dialTpNum.replace("+","00").replace(" ",""),r.page="bounding",r.isOutbounding=!0,r.Name=o.Name,r.Phone=o.Phone,r.Title=o.Title,r.Account=o.Account,r.Id=o.Id,console.log("set into localStorage,calling_info:  "+JSON.stringify(r)),localStorage.setItem("calling_info",JSON.stringify(r)),o.Id?sforce.interaction.screenPop(o.Id,!1,null):e.$router.replace({name:"bounding",params:{OutphoneNum:e.dialTpNum.replace("+","00").replace(" ",""),isOutbounding:!0,recordName:o.Name,phone:o.Phone,title:o.Title,account:o.Account,recordId:o.Id}})}};t({result:'[{"Name":"Mark","Phone":"17551061061","Title":"Customer","Account":"Mark"}]'})}else e.dialTpNum}},_handleNumberKey:function(e){var t=this.dialTpNum;this.dialTpNum=t+e},checkPhone:function(e){var t={telPattern:/^1[3-9]\d{9}$/,phonePattern:/^010\d{8}$|^02\d{9}$|^0[3,4,5,6,7,8,9][0-9]\d{8,9}$/,internationalTelPattern:/^00[0-9]{1,18}$/,fourPattern:/^400\d{7}/,OnePattern:/^1010\d{4}/,nineFivePattern:/^95\d{3}$/,"ar-DZ":/^(\+?213|0)(5|6|7)\d{8}$/,"ar-SY":/^(!?(\+?963)|0)?9\d{8}$/,"ar-SA":/^(!?(\+?966)|0)?5\d{8}$/,"en-US":/^(\+?1)?[2-9]\d{2}[2-9](?!11)\d{6}$/,"cs-CZ":/^(\+?420)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"de-DE":/^(\+?49[ \.\-])?([\(]{1}[0-9]{1,6}[\)])?([0-9 \.\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/,"da-DK":/^(\+?45)?(\d{8})$/,"el-GR":/^(\+?30)?(69\d{8})$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-GB":/^(\+?44|0)7\d{9}$/,"en-HK":/^(\+?852\-?)?[569]\d{3}\-?\d{4}$/,"en-IN":/^(\+?91|0)?[789]\d{9}$/,"en-NZ":/^(\+?64|0)2\d{7,9}$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-ZM":/^(\+?26)?09[567]\d{7}$/,"es-ES":/^(\+?34)?(6\d{1}|7[1234])\d{7}$/,"fi-FI":/^(\+?358|0)\s?(4(0|1|2|4|5)?|50)\s?(\d\s?){4,8}\d$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"he-IL":/^(\+972|0)([23489]|5[0248]|77)[1-9]\d{6}/,"hu-HU":/^(\+?36)(20|30|70)\d{7}$/,"it-IT":/^(\+?39)?\s?3\d{2} ?\d{6,7}$/,"ja-JP":/^(\+?81|0)\d{1,4}[ \-]?\d{1,4}[ \-]?\d{4}$/,"ms-MY":/^(\+?6?01){1}(([145]{1}(\-|\s)?\d{7,8})|([236789]{1}(\s|\-)?\d{7}))$/,"nb-NO":/^(\+?47)?[49]\d{7}$/,"nl-BE":/^(\+?32|0)4?\d{8}$/,"nn-NO":/^(\+?47)?[49]\d{7}$/,"pl-PL":/^(\+?48)? ?[5-8]\d ?\d{3} ?\d{2} ?\d{2}$/,"pt-BR":/^(\+?55|0)\-?[1-9]{2}\-?[2-9]{1}\d{3,4}\-?\d{4}$/,"pt-PT":/^(\+?351)?9[1236]\d{7}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/,"sr-RS":/^(\+3816|06)[- \d]{5,9}$/,"tr-TR":/^(\+?90|0)?5\d{9}$/,"vi-VN":/^(\+?84|0)?((1(2([0-9])|6([2-9])|88|99))|(9((?!5)[0-9])))([0-9]{7})$/,"zh-CN":/^(\+?0?86\-?)?1[345789]\d{9}$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/},n=!1;for(var o in t)e&&t[o].test(e)&&(n=!0);return n||this.$message.error("The number is not avaliable！"),n}}},I=$,A=(n("3675"),Object(u["a"])(I,T,w,!1,null,null,null)),E=A.exports,D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tinet-sf-recent-record"},[n("h1",{staticClass:"title"},[n("b",[e._v("RECENT RECORDS ")]),n("button",{staticStyle:{color:"var(--lwc-brandAccessible,rgb(0, 112, 210))"},attrs:{type:"button"},on:{click:function(t){return e.getRecords()}}},[n("i",{staticClass:"el-icon-refresh"}),e._v(" Refresh ")])]),n("div",{staticClass:"record-box",attrs:{"v-if":e.records}},e._l(e.records,(function(e,t){return n("Record",{key:t,attrs:{record:e}})})),1)])},x=[],L=(n("0d03"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"tinet-sf-record"},[n("div",{staticClass:"record-line1"},[n("div",{staticClass:"record-number",attrs:{title:e.record.customerNumber},on:{click:e.dialNum}},[e._v(e._s(e.record.customerNumber))]),n("div",{staticClass:"record-type"},[e._v(e._s(e.callType))])]),n("div",{staticClass:"record-line2"},[n("div",{staticClass:"record-time"},[e._v(e._s(e._f("dateformat")(1e3*e.record.startTime,"YYYY-MM-DD HH:mm:ss")))]),e.hasAudio?n("div",{staticClass:"record-play"},[e.audioOn?e._e():n("i",{staticClass:"el-icon-video-play",attrs:{id:"play-button",title:"play"},on:{click:e.audioPlay}}),e.audioOn?n("i",{staticClass:"el-icon-video-pause",attrs:{id:"pause-button"},on:{click:e.audioPause}}):n("i",{staticClass:"el-icon-download",attrs:{id:"play-button",title:"download"},on:{click:function(t){return e.audioDowmload(e.recordAudioUrl)}}}),n("audio",{ref:"recordAudio",staticClass:"record-audio",on:{ended:e.audioEnd}},[n("source",{attrs:{src:e.recordAudioUrl,type:"audio/mpeg"}})])]):n("div",{staticClass:"record-play"},[n("i",{staticClass:"el-icon-warning-outline",attrs:{title:"No Recording!"}})])])])])}),J=[];function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M={name:"Record",props:["record"],data:function(){return{audioOn:!1,callType:"",time:"",recordAudioUrl:"",hasAudio:!0}},mounted:function(){console.log(this.record);var e=this;switch(this.record.callType){case 1:case 2:this.callType="Inbound";break;case 3:case 4:case 5:case 6:this.callType="Outbound";break;default:this.callType="-";break}this.record.recordFile?this.$api.getAudio(this.record.recordFile).then((function(t){console.log(t),e.recordAudioUrl=t.result})).catch((function(e){})):this.hasAudio=!1},computed:R({},Object(y["b"])({version:"getVersion"})),methods:{audioDowmload:function(e){var t=document.createElement("a");t.download="download",t.style.display="none",t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)},dialNum:function(){var e=this;if("classic"===e.version){var t=function(t){var n=JSON.parse(t.result);if(t.result){n=JSON.parse(t.result);var o=n[0]?n[0]:{Name:e.dialTpNum},r={};r.OutphoneNum=e.record.customerNumber.replace("+","00").replace(" ",""),r.page="bounding",r.isOutbounding=!0,r.Name=o.Name,r.Phone=o.Phone,r.Title=o.Title,r.Account=o.Account,r.Id=o.Id,console.log("set into localStorage,calling_info:  "+JSON.stringify(r)),localStorage.setItem("calling_info",JSON.stringify(r)),o.Id?sforce.interaction.screenPop(o.Id,!1,null):e.$router.replace({name:"bounding",params:{OutphoneNum:e.record.customerNumber.replace("+","00").replace(" ",""),isOutbounding:!0,recordName:o.Name,phone:o.Phone,title:o.Title,account:o.Account,recordId:o.Id}})}};sforce.interaction.runApex("SoftphoneContactSearchController","getContacts","name="+e.record.customerNumber,t)}else{var n={apexClass:"SoftphoneContactSearchController",methodName:"getContacts",methodParams:"name="+e.record.customerNumber,callback:function(t){if(console.log("OUTBOUNDING, contact search result is "+JSON.stringify(t)),t.success){var n=JSON.parse(t.returnValue.runApex),o=n[0]?n[0]:{Name:e.record.customerNumber},r={};r.OutphoneNum=e.record.customerNumber.replace("+","00").replace(" ",""),r.page="bounding",r.isOutbounding=!0,r.Name=o.Name,r.Phone=o.Phone,r.Title=o.Title,r.Account=o.Account,r.Id=o.Id,console.log("set into localStorage,calling_info:  "+JSON.stringify(r)),localStorage.setItem("calling_info",JSON.stringify(r)),o.Id?sforce.opencti.screenPop({type:sforce.opencti.SCREENPOP_TYPE.SOBJECT,params:{recordId:o.Id}}):sforce.opencti.screenPop({type:sforce.opencti.SCREENPOP_TYPE.NEW_RECORD_MODAL,params:{entityName:"Contact"}}),e.$router.replace({name:"bounding",params:{OutphoneNum:e.record.customerNumber,isOutbounding:!0,recordName:o.Name,phone:o.Phone,title:o.Title,account:o.Account,recordId:o.Id}})}}};sforce.opencti.runApex(n)}},audioPlay:function(){this.$refs.recordAudio.load(),this.audioOn=!0,this.$refs.recordAudio.play(),console.log(this.$refs.recordAudio)},audioPause:function(){this.$refs.recordAudio.pause(),this.audioOn=!1},audioEnd:function(){this.audioOn=!1}}},z=M,V=(n("ad61"),Object(u["a"])(z,L,J,!1,null,null,null)),B=V.exports;function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(n,!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q={name:"recent-record",props:{},computed:H({},Object(y["b"])({cno:"getCno"})),mounted:function(){var e=this;setTimeout((function(){e.getRecords()}),1e3)},data:function(){return{records:[],refreshF:!0}},components:{Record:B},watch:{records:function(e,t){console.log("records "+t+" ->"+e)}},methods:{getRecords:function(){var e=this;e.refreshF=!1,e.records=null;var t=new Date,n=new Date(t.getTime()+60*(480+t.getTimezoneOffset())*1e3),o=new Date(n.getFullYear(),n.getMonth(),n.getDate()).getTime()/1e3;o-=86400;var r=o+172800-1;this.$api.getRecords(o,r).then((function(t){e.records=t.result.data})).catch((function(e){})),e.refreshF=!0}}},K=q,Y=(n("3922"),Object(u["a"])(K,D,x,!1,null,null,null)),G=Y.exports;function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q={name:"home",components:{Header:N,Dial:E,RecentRecord:G},data:function(){return{agent:{}}},computed:Z({},Object(y["b"])({version:"getVersion"})),created:function(){},mounted:function(){var e=this;if(getCookie("agent")){if("classic"===e.version){var t=function(e){e.result};sforce.interaction.cti.enableClickToDial(t)}else sforce.opencti.enableClickToDial({callback:function(){}});"classic"===e.version&&3===JSON.parse(getCookie("agent")).bindType&&(deleteCookie("agent"),e.$alert("Softphone is not supported in classic",{confirmButtonText:"Confirm",callback:function(t){e.$router.replace("/portal"),"classic"===e.version?sforce.interaction.cti.disableClickToDial({}):(sforce.opencti.disableClickToDial({}),e.setPanelLabel("Clink Phone"))}}))}else this.$router.replace("/portal")}},X=Q,ee=Object(u["a"])(X,m,h,!1,null,null,null),te=ee.exports,ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tinet-sf-portal"},[e._m(0),n("LoginForm")],1)},oe=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"portal-poster"},[o("img",{attrs:{src:n("d20d"),alt:""}})])}],re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tinet-sf-login"},[n("el-form",{ref:"loginForm",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:e.$t("portal.username"),prop:"identifier"}},[n("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit(t)}},model:{value:e.form.identifier,callback:function(t){e.$set(e.form,"identifier",t)},expression:"form.identifier"}})],1),n("el-form-item",{attrs:{label:e.$t("portal.agent_no"),prop:"cno"}},[n("el-input",{attrs:{autocomplete:"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit(t)}},model:{value:e.form.cno,callback:function(t){e.$set(e.form,"cno",t)},expression:"form.cno"}})],1),n("el-form-item",{attrs:{label:"Phone Type",prop:"bindType"}},[n("el-radio-group",{staticClass:"tinet-bind-type",model:{value:e.form.bindType,callback:function(t){e.$set(e.form,"bindType",t)},expression:"form.bindType"}},[n("el-radio",{staticClass:"tinet-login-radio",attrs:{label:1}},[e._v("Mobile")]),n("el-radio",{staticClass:"tinet-login-radio",attrs:{label:2}},[e._v("Extension")]),"lightning"==e.version?n("el-radio",{staticClass:"tinet-login-radio",attrs:{label:3}},[e._v("Softphone")]):e._e()],1)],1),n("el-form-item",{attrs:{label:"Phone Number",prop:"bindTel"}},[n("el-input",{attrs:{autocomplete:"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit(t)}},model:{value:e.form.bindTel,callback:function(t){e.$set(e.form,"bindTel",t)},expression:"form.bindTel"}})],1),n("el-form-item",{attrs:{label:e.$t("portal.password"),prop:"password"}},[n("el-input",{attrs:{type:"password",autocomplete:"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit(t)}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),n("el-form-item",[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.bindphone,callback:function(t){e.$set(e.form,"bindphone",t)},expression:"form.bindphone"}})],1),n("el-form-item",[n("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"login-button",attrs:{type:"primary"},on:{click:function(t){return e.onSubmit()}}},[e._v(e._s(e.$t("portal.log_in")))])],1)],1)],1)},ie=[];function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(n,!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce={name:"LoginForm",props:{},data:function(){return{form:{identifier:"",cno:"",bindType:1,bindTel:"",password:"",bindphone:""},rules:{identifier:[{required:!0,message:"Company Code is required",trigger:"blur"}],cno:[{required:!0,message:"Agent No. is required",trigger:"blur"}],bindTel:[{required:!0,message:"Phone Number is required",trigger:"blur"}],password:[{required:!0,message:"Password is required",trigger:"blur"}]},fullscreenLoading:!1}},created:function(){var e=this;console.log("_this"),window.addEventListener("message",(function(t){if(t.source==window.parent){var n=t.data;console.log("b.html 接收到的消息:",n),e.form.bindphone=n,console.log("input的值_this",e.form.bindphone),parent.postMessage("我已经接收到消息了!",t.origin)}}))},mounted:function(){var e=this;this.clinkService.registerAction("login",(function(t){if(0===t.code)if(e.fullscreenLoading=!1,setCookie("agent",JSON.stringify(t.agent)),e.$router.replace("/home"),"classic"===e.version){var n=function(e){e.result&&sforce.interaction.cti.setSoftphoneWidth(400,null)};sforce.interaction.cti.enableClickToDial(n)}else sforce.opencti.enableClickToDial({callback:function(){}});else e.fullscreenLoading=!1,e.$message.error(t.msg),e.clinkService.logout()}))},computed:se({},Object(y["b"])({version:"getVersion"})),methods:{onSubmit:function(){var e=this;this.$store.commit("setCno",this.form.cno),this.$store.commit("setphonenum",this.form.bindphone),console.log("storephonenum",this.$store.commit("setphonenum",this.form.bindphone));this.form.identifier,this.form.cno;this.form.identifier&&this.form.cno&&this.form.password&&(ClinkAgent.login({identifier:this.form.identifier,cno:this.form.cno,password:this.form.password,bindTel:this.form.bindTel,bindType:this.form.bindType,loginStatus:"1",chatLoginStatus:"1",chatLimitNumber:10}),this.fullscreenLoading=!0,setTimeout((function(){e.fullscreenLoading=!1}),1e4))}}},le=ce,ue=(n("1a61"),Object(u["a"])(le,re,ie,!1,null,null,null)),de=ue.exports,pe={name:"Portal",components:{LoginForm:de},data:function(){return{}},mounted:function(){}},fe=pe,me=(n("3cce"),Object(u["a"])(fe,ne,oe,!1,null,null,null)),he=me.exports,ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tinet-sf-bounding"},[n("Header"),n("div",{staticClass:"connecting-person"},[n("el-avatar",{staticClass:"avatar",attrs:{size:80,src:e.circleUrl}}),(e.isOutbounding,n("div",{staticClass:"name"},[e._v(e._s(e.caller?e.caller:e.phoneNum))]))],1),e.isOutbounding?n("div",{staticClass:"status"},[e._v("Calling... "+e._s(e.phoneNum))]):n("div",{staticClass:"status"},[e._v("Incoming... "+e._s(e.phoneNum))]),e.isOutbounding?n("el-button",{staticClass:"outbound-end-button",attrs:{type:"danger"},on:{click:e.hangUp}},[e._v("End")]):n("div",[n("el-button",{staticClass:"outbound-end-button",attrs:{type:"danger"},on:{click:e.decline}},[e._v("Decline")]),3===e.bindType?n("el-button",{staticClass:"outbound-end-button",attrs:{type:"primary"},on:{click:e.accept}},[e._v("Accept")]):e._e()],1)],1)},be=[];function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(n,!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ke={name:"Bounding",components:{Header:N},props:{},data:function(){return{title:"",account:"",recordId:"",isOutbounding:!0,circleUrl:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",caller:"",phoneNum:"",bindType:""}},computed:ye({},Object(y["b"])({version:"getVersion"})),beforeMount:function(){this.isOutbounding=this.$route.params.isOutbounding,this.phoneNum=this.$route.params.phoneNum?this.$route.params.phoneNum:"",this.phoneNum=this.$route.params.OutphoneNum?this.$route.params.OutphoneNum:"",this.caller=this.$route.params.recordName?this.$route.params.recordName:"",this.title=this.$route.params.title?this.$route.params.title:"",this.account=this.$route.params.account?this.$route.params.account:"",this.recordId=this.$route.params.recordId?this.$route.params.recordId:"",this.bindType=this.$route.params.bindType},created:function(){},mounted:function(){var e=this;this.clinkService.registerEvent("previewOutcallBridge",(function(t){console.log("OUTCALL_BRIDGE",t);var n={};n.phoneNum=e.phoneNum,n.page="connecting",n.isOutbounding=!!e.isOutbounding,n.account=e.account,n.recordId=e.recordId,console.log("set into localStorage,calling_info:  "+JSON.stringify(n)),localStorage.setItem("calling_info",JSON.stringify(n)),e.$router.replace({name:"connecting",params:{phoneNum:e.phoneNum,account:e.account,recordId:e.recordId,callType:e.isOutbounding?"Outbound":"Inbound"}})})),this.clinkService.registerAction("previewOutcall",(function(t){-1===t.code&&(localStorage.removeItem("calling_info"),e.$router.replace("/home"))})),this.isOutbounding&&(this.clinkService.callOut({tel:this.phoneNum,callType:4}),"classic"===this.version||(this.recordId?sforce.opencti.screenPop({type:sforce.opencti.SCREENPOP_TYPE.SOBJECT,params:{recordId:this.recordId}}):sforce.opencti.screenPop({type:sforce.opencti.SCREENPOP_TYPE.NEW_RECORD_MODAL,params:{entityName:"Contact"}})))},methods:{hangUp:function(){this.clinkService.hangUp(),localStorage.removeItem("calling_info"),this.$router.replace("/home")},decline:function(){this.clinkService.hangUp(),localStorage.removeItem("calling_info"),this.$router.replace("/home")},accept:function(){ClinkAgent.sipLink(),localStorage.removeItem("calling_info");var e={};e.OutphoneNum=this.phoneNum,e.page="connecting",e.Account=this.account,e.Id=this.recordId,console.log("set into localStorage,calling_info:  "+JSON.stringify(e)),localStorage.setItem("calling_info",JSON.stringify(e)),this.$router.replace({name:"connecting",params:{phoneNum:this.phoneNum,account:this.account,recordId:this.recordId}})}}},Oe=ke,Ce=(n("e834"),Object(u["a"])(Oe,ge,be,!1,null,null,null)),je=Ce.exports,Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tinet-sf-connecting"},[n("Header"),n("div",{staticClass:"note-zone"},[n("div",{staticClass:"connecting-timer"},[e._v("Connected "+e._s(e.phoneNum)+" "+e._s(e.showNum))]),n("el-input",{staticClass:"connecting-note",attrs:{type:"textarea",placeholder:e.notePlaceholder,disabled:e.isNoteDisable,rows:5},model:{value:e.connectingNote,callback:function(t){e.connectingNote=t},expression:"connectingNote"}})],1),n("div",{staticClass:"tinet-connect-function"},[n("div",{staticClass:"button-row"},[e.isHold?n("el-button",{staticClass:"func-button",attrs:{type:"warning",plain:"",icon:"el-icon-video-play"},on:{click:function(t){return e.unhold()}}},[e._v("Unhold")]):n("el-button",{staticClass:"func-button",attrs:{type:"warning",plain:"",icon:"el-icon-video-pause"},on:{click:function(t){return e.hold()}}},[e._v("Hold")]),e.isMute?n("el-button",{staticClass:"func-button",attrs:{type:"primary",plain:"",icon:"el-icon-microphone"},on:{click:function(t){return e.unMute()}}},[e._v("Unmute")]):n("el-button",{staticClass:"func-button",attrs:{type:"primary",plain:"",icon:"el-icon-turn-off-microphone"},on:{click:function(t){return e.mute()}}},[e._v("Mute")])],1)]),n("el-button",{staticClass:"endButton",attrs:{type:"danger"},on:{click:e.endConnecting}},[e._v("End")])],1)},Ne=[],Te=(n("e25e"),n("5118"));function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(n,!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe={name:"connecting",components:{Header:N},props:{},data:function(){return{notePlaceholder:"Enter notes...",isHold:!1,isMute:!1,connectingTime:0,showNum:"00:00",connectingNote:"",isNoteDisable:!1,phoneNum:""}},computed:_e({},Object(y["b"])({version:"getVersion"})),mounted:function(){this.connectingTime=0,this.timer(),this.phoneNum=this.$route.params.phoneNum},beforeDestroy:function(){var e=this,t={entityApiName:"Task",WhoId:e.$route.params.recordId,CallDisposition:"Internal",CallObject:"DemoCall",Description:e.connectingNote,Subject:"Clink Call Log",Priority:"Normal",Status:"Completed",CallDurationInSeconds:e.connectingTime,CallType:e.$route.params.callType,Type:"Call",WhatId:e.$route.params.account};console.log("saveLog",t),sforce.opencti.saveLog({value:t,callback:null})},methods:{timer:function(){var e=this;Object(Te["setInterval"])((function(){e.connectingTime+=1;var t=parseInt(e.connectingTime/60)>9?parseInt(e.connectingTime/60):"0"+parseInt(e.connectingTime/60),n=e.connectingTime%60>9?e.connectingTime%60:"0"+e.connectingTime%60;e.showNum=t+":"+n}),1e3)},endConnecting:function(){this.clinkService.hangUp(),localStorage.removeItem("calling_info"),this.$router.replace("/home")},hold:function(){this.isHold=!0,this.clinkService.hold({holdType:0})},unhold:function(){this.isHold=!1,this.clinkService.unhold({holdType:0})},consult:function(){},consultCansel:function(){this.clinkService.consultCansel()},unconsult:function(){this.clinkService.unconsult()},consultThreeway:function(){this.clinkService.consultThreeway()},consultTransfer:function(){this.clinkService.consultTransfer()},interactive:function(){},satisfaction:function(){this.clinkService.investigation()},mute:function(){this.isMute=!0,this.clinkService.mute()},unMute:function(){this.isMute=!1,this.clinkService.unmute()}}},$e=Pe,Ie=(n("eb15"),Object(u["a"])($e,Se,Ne,!1,null,null,null)),Ae=Ie.exports;o["default"].use(f["a"]);var Ee=[{path:"/",redirect:"home"},{path:"/home",name:"home",component:te},{path:"/portal",name:"portal",component:he},{path:"/bounding",name:"bounding",component:je},{path:"/connecting",name:"connecting",component:Ae}],De=new f["a"]({routes:Ee}),xe=De;o["default"].use(y["a"]);var Le=new y["a"].Store({state:{version:"",cno:"",statusT:"",phonenum:""},mutations:{changeVersion:function(e,t){e.version=t},setCno:function(e,t){e.cno=t},changeStatus:function(e,t){e.statusT=t},setphonenum:function(e,t){e.phonenum=t}},actions:{},getters:{getVersion:function(e){return e.version},getCno:function(e){return e.cno},getStatus:function(e){return e.statusT},getphonenum:function(e){return e.phonenum}},modules:{}}),Je=n("bc3a"),Ue=n.n(Je),Re=n("a7fe"),Me=n.n(Re),ze=(n("caad"),n("a434"),n("2532"),n("9f12")),Ve=n("53fe"),Be={setup:"setup",login:"login",logout:"logout",ping:"ping",online:"online",queueStatus:"queueStatus",pause:"pause",unpause:"unpause",status:"status",previewOutcall:"previewOutcall",directCallStart:"directCallStart",changeBindTel:"changeBindTel",setCdrTag:"setCdrTag",getCdrTag:"getCdrTag",prolongWrapup:"prolongWrapup",unlink:"unlink",previewOutcallCancel:"previewOutcallCancel",hold:"hold",unhold:"unhold",consult:"consult",consultCancel:"consultCancel",consultTransfer:"consultTransfer",consultThreeway:"consultThreeway",unconsult:"unconsult",transfer:"transfer",interact:"interact",investigation:"investigation",refuse:"refuse",mute:"mute",unmute:"unmute",setUserData:"setUserData",getUserData:"getUserData",dtmf:"dtmf",controlPlayback:"controlPlayback",sendVerificationCode:"sendVerificationCode",sipCall:"sipCall",sipLink:"sipLink",sipUnlink:"sipUnlink",sipDTMF:"sipDTMF",spy:"spy",unspy:"unspy",threeway:"threeway",unthreeway:"unthreeway",whisper:"whisper",unwhisper:"unwhisper",pickup:"pickup",disconnect:"disconnect",barge:"barge",pause_client:"pause_client",unpause_client:"unpause_client",chatMessage:"chatMessage",chatInvestigation:"chatInvestigation",chatClose:"chatClose",chatTransfer:"chatTransfer",chatHistory:"chatHistory"},Fe={status:"status",chatStatus:"chatStatus",previewOutcall:"previewOutcall",previewOutcallStart:"previewOutcallStart",previewOutcallRinging:"previewOutcallRinging",previewOutcallBridge:"previewOutcallBridge",consultStart:"consultStart",consultLink:"consultLink",unconsult:"unconsult",consultError:"consultError",consultThreeway:"consultThreeway",consultThreewayUnlink:"consultThreewayUnlink",consultTransfer:"consultTransfer",ringing:"ringing",kickout:"kickout",breakLine:"breakLine",interactReturn:"interactReturn",chatMessage:"chatMessage",chatOnline:"chatOnline",chatBridge:"chatBridge",chatOffline:"chatOffline",chatClose:"chatClose",chatInvestigation:"chatInvestigation",queueStatus:"queueStatus",joinQueue:"joinQueue",leaveQueue:"leaveQueue",spyLink:"spyLink",spyUnlink:"spyUnlink",threewayLink:"threewayLink",threewayUnlink:"threewayUnlink",whisperLink:"whisperLink",whisperUnlink:"whisperUnlink",busyTransfer:"busyTransfer",chatTransfer:"chatTransfer",agendaRemind:"agendaRemind",chatAgentRemind:"chatAgentRemind",ticketNotice:"ticketNotice",visitBridge:"visitBridge"},He=function(){function e(){Object(ze["a"])(this,e),Object(g["a"])(this,"actionCallback",{}),Object(g["a"])(this,"eventCallback",{})}return Object(Ve["a"])(e,[{key:"setup",value:function(){var e=this;ClinkAgent.setup({sipPhone:!0,debug:!0},(function(){console.log("初始化完成"),Object.keys(Fe).forEach((function(t){return ClinkAgent.registerListener(t,e._handleEvent.bind(e))})),Object.keys(Be).forEach((function(t){ClinkAgent.registerCallback(t,e._handleAction.bind(e))}))}))}},{key:"login",value:function(e){ClinkAgent.online(e)}},{key:"logout",value:function(e){window.onbeforeunload=null,ClinkAgent.logout(e)}},{key:"changeBindTel",value:function(e){ClinkAgent.changeBindTel(e)}},{key:"callOut",value:function(e){ClinkAgent.previewOutcall(e)}},{key:"hangUp",value:function(){ClinkAgent.previewOutcallCancel()}},{key:"pickUp",value:function(){ClinkAgent.sipLink()}},{key:"ping",value:function(){ClinkAgent.ping()}},{key:"hold",value:function(e){ClinkAgent.hold(e)}},{key:"unhold",value:function(e){e?ClinkAgent.unhold(e):ClinkAgent.unhold()}},{key:"consult",value:function(e){ClinkAgent.consult(e)}},{key:"consultCansel",value:function(){ClinkAgent.consultCancel()}},{key:"unconsult",value:function(){ClinkAgent.unconsult()}},{key:"transfer",value:function(e){ClinkAgent.transfer(e)}},{key:"interact",value:function(e){ClinkAgent.interact(e)}},{key:"consultThreeway",value:function(){ClinkAgent.consultThreeway()}},{key:"consultTransfer",value:function(){ClinkAgent.consultTransfer()}},{key:"investigation",value:function(){ClinkAgent.investigation()}},{key:"mute",value:function(){ClinkAgent.mute()}},{key:"unmute",value:function(){ClinkAgent.unmute()}},{key:"unpause",value:function(){ClinkAgent.unpause()}},{key:"pause",value:function(e){ClinkAgent.pause(e)}},{key:"chatUnpause",value:function(){ClinkAgent.chatUnpause()}},{key:"chatPause",value:function(e){ClinkAgent.chatPause(e)}},{key:"chatHistory",value:function(e){ClinkAgent.chatHistory(e)}},{key:"dtmf",value:function(e){ClinkAgent.dtmf(e)}},{key:"chatTransfer",value:function(e){ClinkAgent.chatTransfer(e)}},{key:"chatClose",value:function(e){ClinkAgent.chatClose(e)}},{key:"chatInvestigation",value:function(e){ClinkAgent.chatInvestigation(e)}},{key:"getChatFileUrl",value:function(){return ClinkAgent.WsConstant.getWebSocketUrl()}},{key:"_handleEvent",value:function(e){var t=this,n=this.eventCallback[e.event]||[],o=this.uniq(n);o.forEach((function(n){console.log(n),n(e),n.once&&t.unregisterEvent(n.once,n)}))}},{key:"uniq",value:function(e){for(var t=[],n=[],o=e.length,r=0;r<o;r++){for(var i=r+1;i<o;i++)String(e[r])===String(e[i])&&(r++,i=r);t.push(e[r]),n.push(r)}return t}},{key:"_handleAction",value:function(e){var t=this;console.log("拦截action",e,this.actionCallback),-1===e.code&&console.log("error",e.msg);var n=this.actionCallback[e.reqType]||[],o=this.uniq(n);o.forEach((function(n){n(e),n.once&&t.unregisterAction(n.once,n)}))}},{key:"_register",value:function(e,t){return e.includes(t)||e.push(t),t}},{key:"_unregister",value:function(e,t){for(var n=e.length;n;n--){var o=e[n-1];o===t&&e.splice(n-1,1)}}},{key:"registerAction",value:function(e,t){var n=this.actionCallback;n[e]=n[e]||[],this._register(n[e],t)}},{key:"unregisterAction",value:function(e,t){var n=this.actionCallback;n[e]=n[e]||[],this._unregister(n[e],t)}},{key:"emit",value:function(e,t,n){return n&&(n.once=e,this.registerAction(e,n)),ClinkAgent[e](t),n}},{key:"registerEvent",value:function(e,t){var n=this.eventCallback;n[e]=n[e]||[],this._register(n[e],t)}},{key:"unregisterEvent",value:function(e,t){var n=this.eventCallback;n[e]=n[e]||[],this._unregister(n[e],t)}}]),e}(),qe=n("a925"),Ke=n("7f45"),Ye=n.n(Ke),Ge=(n("d3b7"),"https://salesforce-hik.clink.cn/"),We=function(){return Ge},Ze={geturlhead:We},Qe=Ue.a.CancelToken;Ue.a.defaults.baseURL=Ze.geturlhead(),Ue.a.defaults.headers={"Content-Type":"application/json;charset=UTF-8"},Ue.a.defaults.withCredentials=!0,Ue.a.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),Ue.a.interceptors.response.use((function(e){var t;return t=void 0==e.data?e.request.responseText:e.data,t}),(function(e){if(e&&e.response)switch(e.response.status){case 400:e.message="错误请求";break;case 401:e.message="未授权，请重新登录";break;case 403:e.message="拒绝访问";break;case 404:e.message="请求错误,未找到该资源";break;case 405:e.message="请求方法未允许";break;case 408:e.message="请求超时";break;case 500:e.message="服务器端出错";break;case 501:e.message="网络未实现";break;case 502:e.message="网络错误";break;case 503:e.message="服务不可用";break;case 504:e.message="网络超时";break;case 505:e.message="http版本不支持该请求";break;default:e.message="连接错误".concat(e.response.status)}else e.message="连接到服务器失败";return Message({showClose:!0,message:e.message,type:"error"}),Promise.resolve(e.response)}));var Xe={get:function(e,t){return new Promise((function(n,o){Ue()({method:"get",url:e,params:t,cancelToken:new Qe((function(e){e}))}).then((function(e){n(e)})).catch((function(e){o(e)}))}))},post:function(e,t){return new Promise((function(n,o){Ue()({method:"post",url:e,data:t}).then((function(e){n(e)})).catch((function(e){o(e)}))}))},put:function(e,t){return new Promise((function(n,o){Ue()({method:"put",url:e,data:t}).then((function(e){n(e)})).catch((function(e){o(e)}))}))}},et=function(e,t){return Xe.get("api/cdr?offset=0&limit=50&startTime="+e+"&endTime="+t)},tt=function(e){return Xe.get("api/cdr/recording/"+e)},nt={getRecords:et,getAudio:tt};o["default"].config.productionTip=!1,o["default"].use(i.a),o["default"].use(Me.a,Ue.a),o["default"].use(qe["a"]),o["default"].prototype.$api=nt,o["default"].prototype.clinkService=new He,o["default"].prototype.clinkService.setup(),Ye.a.tz.setDefault(Ye.a.tz.guess()),o["default"].filter("dateformat",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return Ye()(e).format(t)}));var ot=new qe["a"]({locale:"en",messages:{zh:n("f9dc"),en:n("6a6a")}});new o["default"]({router:xe,store:Le,i18n:ot,render:function(e){return e(p)}}).$mount("#app")},"623e":function(e,t,n){},"6a6a":function(e){e.exports=JSON.parse('{"portal":{"log_in":"log in","username":"Company Code","agent_no":"Agent No","password":"Password"}}')},7238:function(e,t,n){},"7c55":function(e,t,n){"use strict";var o=n("2395"),r=n.n(o);r.a},"97e8":function(e,t,n){},"9bbe":function(e,t,n){},a901:function(e,t,n){"use strict";var o=n("328b"),r=n.n(o);r.a},ad61:function(e,t,n){"use strict";var o=n("97e8"),r=n.n(o);r.a},bf61:function(e,t,n){},c81e:function(e,t,n){},d20d:function(e,t,n){e.exports=n.p+"img/demoAdapterLogo.e2e97bb1.png"},e834:function(e,t,n){"use strict";var o=n("c81e"),r=n.n(o);r.a},eb15:function(e,t,n){"use strict";var o=n("bf61"),r=n.n(o);r.a},f9dc:function(e){e.exports=JSON.parse('{"portal":{"log_in":"log in","username":"User Name","agent_no":"Agent No","password":"Password"}}')}});